{"version":3,"sources":["modernizr-touch.js","model.js","view.js","controller.js","index.js"],"names":[],"mappings":"AAAA;AACA;AACA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourcesContent":["/*! modernizr 3.6.0 (Custom Build) | MIT *\n * https://modernizr.com/download/?-touchevents-setclasses !*/\n!function(e,n,t){function o(e){var n=u.className,t=Modernizr._config.classPrefix||\"\";if(p&&(n=n.baseVal),Modernizr._config.enableJSClass){var o=new RegExp(\"(^|\\\\s)\"+t+\"no-js(\\\\s|$)\");n=n.replace(o,\"$1\"+t+\"js$2\")}Modernizr._config.enableClasses&&(n+=\" \"+t+e.join(\" \"+t),p?u.className.baseVal=n:u.className=n)}function s(e,n){return typeof e===n}function a(){var e,n,t,o,a,i,r;for(var l in c)if(c.hasOwnProperty(l)){if(e=[],n=c[l],n.name&&(e.push(n.name.toLowerCase()),n.options&&n.options.aliases&&n.options.aliases.length))for(t=0;t<n.options.aliases.length;t++)e.push(n.options.aliases[t].toLowerCase());for(o=s(n.fn,\"function\")?n.fn():n.fn,a=0;a<e.length;a++)i=e[a],r=i.split(\".\"),1===r.length?Modernizr[r[0]]=o:(!Modernizr[r[0]]||Modernizr[r[0]]instanceof Boolean||(Modernizr[r[0]]=new Boolean(Modernizr[r[0]])),Modernizr[r[0]][r[1]]=o),f.push((o?\"\":\"no-\")+r.join(\"-\"))}}function i(){return\"function\"!=typeof n.createElement?n.createElement(arguments[0]):p?n.createElementNS.call(n,\"http://www.w3.org/2000/svg\",arguments[0]):n.createElement.apply(n,arguments)}function r(){var e=n.body;return e||(e=i(p?\"svg\":\"body\"),e.fake=!0),e}function l(e,t,o,s){var a,l,f,c,d=\"modernizr\",p=i(\"div\"),h=r();if(parseInt(o,10))for(;o--;)f=i(\"div\"),f.id=s?s[o]:d+(o+1),p.appendChild(f);return a=i(\"style\"),a.type=\"text/css\",a.id=\"s\"+d,(h.fake?h:p).appendChild(a),h.appendChild(p),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(n.createTextNode(e)),p.id=d,h.fake&&(h.style.background=\"\",h.style.overflow=\"hidden\",c=u.style.overflow,u.style.overflow=\"hidden\",u.appendChild(h)),l=t(p,e),h.fake?(h.parentNode.removeChild(h),u.style.overflow=c,u.offsetHeight):p.parentNode.removeChild(p),!!l}var f=[],c=[],d={_version:\"3.6.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,n){var t=this;setTimeout(function(){n(t[e])},0)},addTest:function(e,n,t){c.push({name:e,fn:n,options:t})},addAsyncTest:function(e){c.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=d,Modernizr=new Modernizr;var u=n.documentElement,p=\"svg\"===u.nodeName.toLowerCase(),h=d._config.usePrefixes?\" -webkit- -moz- -o- -ms- \".split(\" \"):[\"\",\"\"];d._prefixes=h;var m=d.testStyles=l;Modernizr.addTest(\"touchevents\",function(){var t;if(\"ontouchstart\"in e||e.DocumentTouch&&n instanceof DocumentTouch)t=!0;else{var o=[\"@media (\",h.join(\"touch-enabled),(\"),\"heartz\",\")\",\"{#modernizr{top:9px;position:absolute}}\"].join(\"\");m(o,function(e){t=9===e.offsetTop})}return t}),a(),o(f),delete d.addTest,delete d.addAsyncTest;for(var v=0;v<Modernizr._q.length;v++)Modernizr._q[v]();e.Modernizr=Modernizr}(window,document);","\r\n\r\nclass Pages {\r\n\r\n    constructor(){\r\n\r\n        this.state = 'index';\r\n    }\r\n\r\n    set currentState(index) {\r\n\r\n        this.state = index;\r\n    }\r\n\r\n    get currentState() {\r\n\r\n        return this.state;\r\n    }\r\n}\r\n\r\n\r\nclass News {\r\n\r\n    constructor(type = 'top-headlines',lang = 'ru'){\r\n\r\n        this.KEY = '92084bd2e2064d8d856eb2c499818785';\r\n        this.URI = 'https://newsapi.org/v2/';\r\n        this.CATEGORY = 'technology';\r\n        this.type = type;\r\n        this.country = `country=${lang}`;\r\n        this.buffer = false;\r\n        this.correctUTF = [];\r\n        this.articlesNews = [];\r\n\r\n        this.error = null;\r\n    }\r\n\r\n    getCoords(){\r\n        \r\n\r\n          function error(err) {\r\n\r\n            let coords ={\r\n                latitude: 53.9130256,\r\n                longitude: 27.4998984,\r\n                error: true,\r\n            }\r\n\r\n            localStorage.coords = JSON.stringify(coords);\r\n          };\r\n\r\n\r\n        navigator.geolocation.getCurrentPosition(function success(pos) {\r\n            let response = pos.coords;\r\n            \r\n            let coords ={\r\n                latitude: response.latitude,\r\n                longitude: response.longitude,\r\n                error: false,\r\n            }\r\n\r\n\r\n            localStorage.coords = JSON.stringify(coords);\r\n        },error);\r\n\r\n\r\n    }\r\n\r\n    static mapInit(mapIn = document.querySelector('.ol-viewport')){\r\n\r\n        if (!mapIn){\r\n\r\n        let mousePositionControl = new ol.control.MousePosition( {\r\n            // используется градусная проекция\r\n            projection: 'EPSG:4326',\r\n            // переопределяем функцию вывода координат\r\n            coordinateFormat: function(coordinate) {\r\n                // сначала широта, потом долгота и ограничиваем до 3 знаков после запятой\r\n                return ol.coordinate.format(coordinate, '{y}, {x}', 3);\r\n            }\r\n    } );\r\n\r\n        return new ol.Map({\r\n            controls: ol.control.defaults().extend([\r\n                new ol.control.ZoomSlider(),\r\n                mousePositionControl,\r\n                new ol.control.OverviewMap(),\r\n                new ol.control.ScaleLine()\r\n            ]),\r\n            target: 'map',\r\n            layers: [\r\n                new ol.layer.Tile({\r\n\r\n                    source: new ol.source.OSM()\r\n\r\n                })\r\n            ],\r\n            view: new ol.View({\r\n            center: ol.proj.fromLonLat([27.4998984,53.9130256]),\r\n            zoom: 7\r\n            })\r\n        });\r\n\r\n        }\r\n\r\n    }\r\n\r\n    request(view,pages,db){\r\n\r\n        if (!window.fetch) return false;\r\n        \r\n        window.fetch(`${this.URI+this.type}?${this.country}&category=${this.CATEGORY}&apiKey=${this.KEY}`)\r\n\r\n        .then(response => response.json())\r\n        .then(response => sessionStorage.news = JSON.stringify(response.articles))\r\n        .then(response => { return db.openDateBase(view,pages,response);})\r\n\r\n        .catch((error) => {\r\n\r\n            sessionStorage.state = window.location.hash.slice(2);\r\n            pages.currentState = sessionStorage.state;\r\n            view.showNews();\r\n            view.checkState(pages);\r\n            view.customElements(document.querySelector('.loader'),'delete');\r\n        });\r\n}\r\n\r\n\r\n    parseJsonNews(article = sessionStorage.news){\r\n\r\n        return article ? JSON.parse(article) : false;\r\n    }\r\n\r\n    stringifyNews(article){\r\n\r\n        sessionStorage.news = JSON.stringify(article);\r\n    }\r\n}\r\n\r\n\r\nclass DataBase {\r\n\r\n    constructor(data = []){\r\n        this.storeData = [];\r\n        this.requestArticle = [];\r\n        this.dbItems = null;\r\n    }\r\n\r\n    openDateBase(view,pages,storeData){\r\n\r\n        let self = this;\r\n\r\n        this.requestArticle = JSON.parse(sessionStorage.news);\r\n\r\n        if (!window.indexedDB) return;\r\n\r\n        const dbPromise = window.indexedDB.open('newsDB',1);\r\n        dbPromise.onupgradeneeded = function(event) {\r\n            \r\n            const db = event.target.result;\r\n            let objectStore = db.createObjectStore(\"news\", {autoIncrement:true});\r\n\r\n            // Create an index to search customers by name. We may have duplicates\r\n            // so we can't use a unique index.\r\n            objectStore.createIndex(\"name\",'name', { unique: false });\r\n\r\n            // Store values in the newly created objectStore.\r\n\r\n            for (let i = 0; i < self.storeData.length; i++){\r\n\r\n                objectStore.add(self.storeData[i]);\r\n            }\r\n\r\n        };\r\n\r\n        dbPromise.onsuccess = (e) => { \r\n            \r\n            const db = e.target.result;\r\n\r\n            this.dbItems = db.transaction('news').objectStore('news').getAll();\r\n        \r\n            this.dbItems.onsuccess = (e) => {\r\n                const news = e.target.result;\r\n    \r\n                         this.correctUTF = [];\r\n                         \r\n                        this.buffer = news.length ? news : this.requestArticle;\r\n                            \r\n            \r\n                        for (let item of this.buffer){\r\n\r\n                            (item.source) && (item.name = item.source.name);\r\n                            item.source && (delete item.source);\r\n                            item.author !== undefined && (delete item.author);\r\n                            item.content !== undefined && (delete item.content);\r\n                        }\r\n                        \r\n                        let filterNews =  this.requestArticle.filter( (item,i) =>{\r\n                        let its = this.buffer.find(it => it.description === item.description);\r\n                        return  its === undefined;\r\n                        });\r\n                        \r\n                        if (filterNews.length) {\r\n                            filterNews.forEach(element => this.buffer.unshift(element));\r\n                            console.log(filterNews);\r\n                        }\r\n                        \r\n                        let findItem = this.buffer || this.requestArticle;\r\n\r\n                        this.correctUTF = findItem.filter (item => item.name != 'Rg.ru');\r\n\r\n                        let trans = db.transaction('news','readwrite');\r\n            \r\n                        for (let i = 0; i < this.correctUTF.length; i++ ){\r\n                            \r\n                            trans.objectStore('news').put(this.correctUTF[i],i+1);\r\n                        }\r\n\r\n                    sessionStorage.removeItem('news');\r\n  \r\n                    sessionStorage.state = window.location.hash.slice(2);\r\n                    pages.currentState = sessionStorage.state;\r\n                    view.showNews(news);\r\n                    view.checkState(pages);\r\n                    view.customElements(document.querySelector('.loader'),'delete');\r\n\r\n    }\r\n\r\n        }\r\n    // .then(db => {  console.log(db);  /* db.result.transaction('news').objectStore('news').getAll() */ })\r\n    //     .then(news => {\r\n    //         \r\n    //         news.onsuccess = (e) => {\r\n    //          this.correctUTF = [];\r\n    //         this.buffer = news ? news : this.articlesNews;\r\n    //             \r\n\r\n    //         for (let item of this.buffer){\r\n\r\n    //            (item.source) && (item.name = item.source.name);\r\n\r\n    //            item.source && (delete item.source);\r\n    //            item.author !== undefined && (delete item.author);\r\n    //            item.content !== undefined && (delete item.content);\r\n\r\n    //         }\r\n\r\n    //         let filterNews =  this.articlesNews.filter( (item,i) =>{\r\n\r\n    //         let its = this.buffer.find(it => it.description === item.description);\r\n\r\n    //         return  its === undefined;\r\n    //         });\r\n\r\n    //         if (filterNews.length) {\r\n                \r\n    //             filterNews.forEach(element => this.buffer.unshift(element));\r\n    //             console.log(filterNews);\r\n    //         }\r\n\r\n    //         let findItem = this.buffer || this.articlesNews;\r\n\r\n    //         this.correctUTF = findItem.filter (item => item.name != 'Rg.ru');\r\n\r\n\r\n    //         let trans = db.result.transaction('news','readwrite');\r\n\r\n    //         for (let i = 0; i < this.correctUTF.length; i++ ){\r\n    //             \r\n    //             trans.objectStore('news').put(this.correctUTF[i],i+1);\r\n    //         }\r\n\r\n    //     }\r\n\r\n    //     })\r\n\r\n\r\n    //     .catch((err) => { console.log(err); });\r\n    // }\r\n\r\n    }\r\n}\r\n","\r\nclass ViewNews {\r\n\r\n    constructor(ctx = document.createElement('div')){\r\n        this.ctx = ctx;\r\n        this.content = null;\r\n        this.menu = ['main','about','contact'];\r\n        this.news = localStorage.news ? JSON.parse(localStorage.news) : [];\r\n        this.newsSection = [];\r\n        this.count = 6;\r\n        this.numPage = 1;\r\n        this.countShow = 18;\r\n        this.numContent = 18; // start\r\n        this.lengthLoading = 0;\r\n\r\n\r\n        this.components = {\r\n            header: null,\r\n            footer: null,\r\n            loadMoreBox: null,\r\n            loadingNews: null,\r\n            contentSection: null,\r\n            nav: null,\r\n            wrapperHeader: null,\r\n            navigator: null,\r\n            title: null,\r\n            footerWrapper: null,\r\n            footerPower: null,\r\n        }\r\n    }\r\n\r\n    updateBroswer(){\r\n\r\n        let content = document.querySelector('.content');\r\n\r\n        let support = document.createElement('h2');\r\n        support.classList.add('updateIE');\r\n\r\n        support.innerHTML = \"Please update browser or if you use IE download a modern browser.\";\r\n        content.appendChild(support);\r\n        \r\n    }\r\n\r\n    showScrollUp(){\r\n\r\n        let scrollUp = document.createElement('div');\r\n        scrollUp.classList.add('scroll');\r\n        scrollUp.innerHTML = '<i class=\"fa-2x fas fa-arrow-up positionIcon\"></i>';\r\n\r\n        this.ctx.appendChild(scrollUp);\r\n    }\r\n\r\n    customElements(target,type = 'none',name = 'Спрятать') {\r\n        \r\n\r\n        type === 'disabled' && target.setAttribute('disabled','true');\r\n        type === 'delete' && target.parentNode.removeChild(target);\r\n        type === 'rename' && (target.value = name);\r\n\r\n    }\r\n\r\n    loadingNews(target = false){\r\n\r\n\r\n            let lastSection = document.getElementsByTagName('section');\r\n            let contentSection = document.querySelector('.content');\r\n            lastSection = lastSection[lastSection.length-1];\r\n            let num = this.newsSection.length-1;\r\n            this.newContent = this.news.filter( (element,i) => i > this.numContent);\r\n\r\n            let countArticle = Math.ceil(this.countShow / 3);\r\n\r\n            for(let j = 0; j < countArticle; j++){\r\n                let section = document.createElement('section');\r\n                this.newsSection.push(section);\r\n            }\r\n;\r\n            this.lengthLoading = this.newContent.length > this.countShow ? this.countShow-1 : this.newContent.length;\r\n\r\n            for(let i = 0; i < this.lengthLoading; i++){\r\n\r\n                let read = document.createElement('a');\r\n                let article = document.createElement('div');\r\n                let img = document.createElement('img');\r\n                console.log(this.newContent[i].urlToImage);\r\n                img.src = this.newContent[i].urlToImage  ? this.newContent[i].urlToImage : 'img/technology.jpg';\r\n                img.classList.add('topic-image');\r\n                let content = document.createElement('p');\r\n\r\n                content.classList.add('article__content');\r\n                article.classList.add('article-col');\r\n                article.classList.add('rel-col');\r\n\r\n                read.href = this.newContent[i].url;\r\n                read.classList.add('article__content__read');\r\n\r\n\r\n                content.innerHTML = this.newContent[i].description != null ? this.newContent[i].description : this.newContent[i].title;\r\n\r\n                article.appendChild(img);\r\n                article.appendChild(content);\r\n                article.appendChild(read);\r\n                this.newsSection[num].appendChild(article);\r\n\r\n                if ((i % 3 === 0) || i === 0) num++;\r\n\r\n                }\r\n\r\n            for (let ij = 7; ij < this.newsSection.length-1; ij++){\r\n\r\n                let parent = target.parentNode;\r\n                contentSection.insertBefore(this.newsSection[ij],parent);\r\n\r\n            }\r\n\r\n            this.numContent = this.numContent+18;\r\n    }\r\n\r\n\r\n    showLoadingButton(){\r\n\r\n        this.components.loadMoreBox = document.createElement('div');\r\n        this.components.loadMoreBox.classList.add('controllSection');\r\n\r\n        this.components.loadMoreBox = document.createElement('div');\r\n        this.components.loadMoreBox.classList.add('controllSection');\r\n\r\n        this.components.loadingNews = document.createElement('input');\r\n        this.components.loadingNews.setAttribute('type','button');\r\n        this.components.loadingNews.classList.add('loadingNewsBtn');\r\n        this.components.loadingNews.value = 'Загрузить';\r\n\r\n        this.components.loadMoreBox.appendChild(this.components.loadingNews);\r\n    }\r\n\r\n\r\n    showComponents(){\r\n\r\n        this.ctx.innerHTML = '';\r\n\r\n        this.components.header = document.createElement('header');\r\n        this.components.footer = document.createElement('footer');\r\n\r\n        this.components.contentSection = document.createElement('div');\r\n        this.components.contentSection.classList.add('content');\r\n\r\n        this.components.nav = document.createElement('nav');\r\n        this.components.wrapperHeader = document.createElement('div');\r\n        this.components.navigator = document.createElement('ul');\r\n        this.components.navigator.classList.add('menu');\r\n\r\n        this.components.wrapperHeader.classList.add('row-center');\r\n        this.components.title = document.createElement('h1');\r\n        this.components.title.innerHTML = 'Technology news';\r\n        this.components.title.classList.add('title');\r\n\r\n        this.components.footerWrapper = document.createElement('div');\r\n        this.components.footerWrapper.classList.add('footerWrapper');\r\n        this.components.footerPower = document.createElement('p');\r\n        this.components.footerPower.classList.add('footerWrapper__powerd');\r\n        this.components.footerPower.innerHTML = 'Create by themafia98 (Pavel P)';\r\n\r\n\r\n        for (let i = 0; i < 3; i++){\r\n\r\n            let li = document.createElement('li');\r\n            let link = document.createElement('a');\r\n            link.setAttribute('href', `#!${this.menu[i]}`);\r\n            link.dataset.menu = this.menu[i];\r\n            link.innerHTML = this.menu[i];\r\n            li.appendChild(link);\r\n            this.components.navigator.appendChild(li);\r\n        }\r\n\r\n        this.showLoadingButton();\r\n\r\n        this.components.nav.appendChild(this.components.navigator);\r\n        this.components.footerWrapper.appendChild(this.components.footerPower);\r\n\r\n        this.components.wrapperHeader.appendChild(this.components.title);\r\n        this.components.wrapperHeader.appendChild(this.components.nav);\r\n\r\n        this.components.footer.appendChild(this.components.footerWrapper);\r\n\r\n        this.components.header.appendChild(this.components.wrapperHeader);\r\n        this.ctx.appendChild(this.components.header);\r\n        this.ctx.appendChild(this.components.contentSection);\r\n        this.ctx.appendChild(this.components.footer);\r\n\r\n        this.content = document.querySelector('.content');\r\n\r\n    }\r\n\r\n    showNews(db = []){\r\n\r\n        this.content.innerHTML = '';\r\n        this.newsSection = [];\r\n\r\n        if (this.lengthLoading >= 18){\r\n\r\n            this.numContent = 18;\r\n            this.lengthLoading = 0;\r\n            this.showLoadingButton();\r\n        }\r\n        \r\n        this.news = db;\r\n        \r\n\r\n\r\n        let countArticle = Math.ceil(this.countShow / 3);\r\n        let num = 0;\r\n\r\n        for(let j = 0; j < countArticle+1; j++){\r\n\r\n            let section = document.createElement('section');\r\n            this.newsSection.push(section);\r\n        }\r\n        ;\r\n        let length = this.countShow + this.lengthLoading;\r\n\r\n        for(let i = 0; i < length; i++){\r\n\r\n            if (this.news.length === 0) break;\r\n            let read = document.createElement('a');\r\n\r\n            let article = document.createElement('div');\r\n            let img = document.createElement('img');\r\n            img.src = this.news[i].urlToImage ? this.news[i].urlToImage : 'img/technology.jpg';\r\n            img.classList.add('topic-image');\r\n            let content = document.createElement('p');\r\n            content.classList.add('article__content');\r\n            article.classList.add('article-col');\r\n            article.classList.add('rel-col');\r\n\r\n            if (i === 0) {\r\n                read.href = this.news[i].url;\r\n                read.classList.add('hot-article__content__read');\r\n                read.innerHTML = 'Читать';\r\n                this.newsSection[i].classList.add('hot-topic');\r\n                content.classList.add('hot-topic_content');\r\n                img.classList.add('hot-image');\r\n            } else {\r\n\r\n                read.href = this.news[i].url;\r\n                read.classList.add('article__content__read');\r\n            }\r\n\r\n            content.innerHTML = (this.news[i].description != '' && this.news[i].description != null) ? this.news[i].description : this.news[i].title;\r\n            article.appendChild(img);\r\n            article.appendChild(content);\r\n            article.appendChild(read);\r\n\r\n            if (this.lengthLoading > 0){\r\n\r\n                !(this.newsSection[num]) && (this.newsSection[num] = document.createElement('section'));\r\n            }\r\n\r\n            this.newsSection[num].appendChild(article);\r\n            if (i % 3 === 0) num++;\r\n        }\r\n\r\n        this.newsSection.forEach (item => this.components.contentSection.appendChild(item));\r\n        this.components.contentSection.appendChild(this.components.loadMoreBox);\r\n        this.ctx.insertBefore(this.components.contentSection,this.components.header.nextSibling);\r\n    }\r\n\r\n    checkState(pages){\r\n\r\n        (pages.currentState === 'about') && this.showAbout();\r\n        (pages.currentState === 'contact') && this.showContact();\r\n        if (pages.currentState === 'main' || '') {\r\n            \r\n            this.showNews(this.news);\r\n\r\n        }\r\n    }\r\n\r\n    showAbout() {\r\n        \r\n        this.content.innerHTML = '';\r\n\r\n        let titleState = document.createElement('h2');\r\n        titleState.classList.add('state-title');\r\n        titleState.innerHTML = 'About';\r\n\r\n        let aboutWrapper = document.createElement('div');\r\n        aboutWrapper.classList.add('aboutWrapper');\r\n\r\n        let aboutArticle = document.createElement('p');\r\n        aboutArticle.classList.add('aboutArticle');\r\n        aboutArticle.innerHTML = 'This is a test project. Use a <a href = \"https://newsapi.org/\">News API</a>.';\r\n\r\n\r\n        let aboutMe = document.createElement('p');\r\n        aboutMe.classList.add('aboutMe');\r\n        aboutMe.innerHTML = 'My name is Pavel Petrovich and i like <strong>JavaScript</strong>.';\r\n        let imageJs = document.createElement('img');\r\n        imageJs.classList.add('imagesAbout');\r\n        imageJs.src = 'img/javascript.png';\r\n\r\n        aboutWrapper.appendChild(aboutArticle);\r\n        aboutWrapper.appendChild(aboutMe);\r\n        imageJs.onload = () => aboutWrapper.appendChild(imageJs);\r\n\r\n        this.content.appendChild(titleState);\r\n        this.content.appendChild(aboutWrapper);\r\n    }\r\n\r\n    showContact(){\r\n\r\n        this.content.innerHTML = '';\r\n\r\n        let titleState = document.createElement('h2');\r\n        titleState.classList.add('state-title');\r\n        titleState.innerHTML = 'Contact';\r\n\r\n        let aboutWrapper = document.createElement('div');\r\n        aboutWrapper.classList.add('aboutWrapper');\r\n\r\n        let aboutArticle = document.createElement('p');\r\n        aboutArticle.classList.add('contact-links');\r\n        aboutArticle.innerHTML = '<a href = \"https://github.com/themafia98\"><i class=\"fab fa-github-square\"></i></a>' +\r\n                                 ' <a href = \"https://www.linkedin.com/in/pavel-p-80887b151/\"><i class=\"fab fa-linkedin\"></i></a>';\r\n\r\n        let map = document.createElement('div');\r\n        map.setAttribute('id','map');\r\n\r\n        aboutWrapper.appendChild(aboutArticle);\r\n\r\n        this.content.appendChild(titleState);\r\n        this.content.appendChild(aboutWrapper);\r\n        this.content.appendChild(map);\r\n\r\n        let maps = News.mapInit();\r\n        let coords = JSON.parse(localStorage.coords);\r\n\r\n        let mapp = document.querySelector('.ol-viewport');\r\n\r\n        let currentMarker = document.createElement('div');\r\n        currentMarker.classList.add('markerCurrent');\r\n\r\n        let marker = document.createElement('div');\r\n        marker.classList.add('marker');\r\n\r\n        mapp.appendChild(currentMarker);\r\n        mapp.appendChild(marker);\r\n\r\n        if (!coords.error) {\r\n        let markerYour = new ol.Overlay({\r\n            position: ol.proj.fromLonLat([coords.longitude,coords.latitude]),\r\n            element: document.querySelector('.marker'),\r\n            positioning: 'bottom-center'\r\n        });\r\n        maps.addOverlay(markerYour);\r\n        } else document.querySelector('.marker').style.display = 'none';\r\n\r\n        let markerCurrent = new ol.Overlay({\r\n            position: ol.proj.fromLonLat([27.4998984,53.9130256]),\r\n            element: document.querySelector('.markerCurrent'),\r\n            positioning: 'bottom-center'\r\n        });\r\n        maps.addOverlay(markerCurrent);\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    showLoader(){\r\n\r\n        let app = document.getElementById('newsApp');\r\n\r\n        let loadWrapper = document.createElement('div');\r\n        loadWrapper.classList.add('loadingWrapper');\r\n        let load = document.createElement('img');\r\n        load.classList.add('loader');\r\n        load.src = 'img/loading.gif';\r\n\r\n        loadWrapper.appendChild(load);\r\n\r\n        this.ctx.insertBefore(loadWrapper,this.components.header.nextSibling);\r\n    }\r\n}","class Controller {\r\n\r\n    constructor (){\r\n\r\n        this.menu = null;\r\n        this.menuTitle = null;\r\n        this.timer = null;\r\n        this.scrolled = null;\r\n        this.clickScrollCount = 0;\r\n\r\n\r\n    }\r\n\r\n    setDbEvents(dateNews,storeData){\r\n\r\n        dateNews.onupgradeneeded = function(event) {\r\n            \r\n\r\n            const db = event.target.result;\r\n\r\n            // Create an objectStore to hold information about our customers. We're\r\n            // going to use \"id\" as our key path because it's guaranteed to be\r\n            // unique.\r\n            let objectStore = db.createObjectStore(\"news\", {autoIncrement:true});\r\n\r\n            // Create an index to search customers by name. We may have duplicates\r\n            // so we can't use a unique index.\r\n            objectStore.createIndex(\"name\",'name', { unique: false });\r\n\r\n            // Store values in the newly created objectStore.\r\n\r\n            for (let i = 0; i < storeData.length; i++){\r\n\r\n                objectStore.add(storeData[i]);\r\n            }\r\n\r\n        };\r\n\r\n        dateNews.onsuccess = function(event) { //если база открылась и все в порядке\r\n            \r\n            const db = event.target.result;\r\n\r\n            let objectStore = db.transaction([\"news\"], \"readwrite\");\r\n            const store = objectStore.objectStore(\"news\");\r\n\r\n            store.openCursor().onsuccess = function(event) {\r\n                let cursor = event.target.result;\r\n\r\n                if (cursor) cursor.continue();\r\n            };\r\n\r\n\r\n        \r\n        };\r\n    }\r\n\r\n    setEvents (view,model,pages){\r\n\r\n        let self = this;\r\n\r\n        function scroll(e) {\r\n\r\n            self.menu = document.getElementsByTagName('nav')[0];\r\n            self.scrolled = window.pageYOffset || document.documentElement.scrollTop;\r\n\r\n\r\n            if (self.timer != null && self.scrolled === 0) { \r\n\r\n                clearInterval(self.timer);\r\n                self.clickScrollCount = 0;\r\n            };\r\n            console.log(self.scrolled);\r\n            if (self.scrolled > 100) {\r\n\r\n                self.menu.classList.add('fixed-menu');\r\n                (!document.querySelector('.scroll') && !Modernizr.touchevents) && view.showScrollUp();\r\n\r\n            } else if (self.menu.classList[0] == 'fixed-menu' && self.scrolled < 100) {\r\n\r\n                let scroll =  document.querySelector('.scroll');\r\n                self.menu.classList.toggle('fixed-menu');\r\n                scroll && scroll.parentNode.removeChild(scroll); // || remove()\r\n            }\r\n\r\n        };\r\n\r\n\r\n        \r\n        function clickEvent(e) {\r\n            \r\n            let target = e.target;\r\n\r\n            if (target.classList[0] === 'loadingNewsBtn'){\r\n\r\n            view.numContent < 36 && view.loadingNews(target);\r\n            view.numContent >= 36 && view.customElements(target,'delete');\r\n            }\r\n\r\n            if((target.classList[0] === 'scroll' || target.parentNode.classList[0] === 'scroll') && \r\n                self.clickScrollCount === 0){\r\n\r\n                self.clickScrollCount++;\r\n                self.timer =  setInterval(function tick() {\r\n                document.documentElement.scrollTop = document.documentElement.scrollTop - 20;\r\n                },0);\r\n            }\r\n\r\n        };\r\n\r\n\r\n\r\n        /* -----------Modernizr----------- */\r\n        console.log('touchevents detected:' + Modernizr.touchevents);\r\n        Modernizr.touchevents && document.addEventListener('touchend',clickEvent,false);\r\n        !Modernizr.touchevents && document.addEventListener('click',clickEvent,false);\r\n\r\n        window.addEventListener('storage', (e) => {  view.showNews() },false);\r\n        document.addEventListener('scroll',scroll,false);\r\n\r\n\r\n        document.addEventListener('DOMContentLoaded',() => {\r\n\r\n            let article = model.parseJsonNews();\r\n\r\n            if (article.length > 35){\r\n\r\n                while (article.length > 37) article.pop();\r\n                model.stringifyNews(article);\r\n            }\r\n\r\n\r\n\r\n        },false);\r\n\r\n\r\n        window.addEventListener('hashchange', updateState);\r\n\r\n        function updateState(e) {\r\n\r\n            sessionStorage.state = window.location.hash.slice(2);\r\n            pages.currentState = sessionStorage.state;\r\n\r\n            view.checkState(pages);\r\n        }\r\n\r\n    }\r\n}\r\n\r\n\r\n","\r\nimport { fetch as fetchPolyfill } from '../js/3rd/fetch.js';\r\n\r\nlet app = (function(){\r\n\r\n\r\n    function main(){\r\n\r\n        const pages = new Pages();\r\n        const news = new News();\r\n\r\n        news.getCoords();\r\n\r\n        const view = new ViewNews(document.getElementById('newsApp'));\r\n        const controll = new Controller();\r\n        controll.setEvents(view,news,pages);\r\n        view.showComponents();\r\n        view.showLoader();\r\n\r\n        const db = new DataBase(news.articlesNews);\r\n        const have = news.request(view,pages,db);\r\n\r\n        if (have === false) {\r\n\r\n            view.customElements(document.querySelector('.loader'),'delete');\r\n            view.updateBroswer();\r\n        }\r\n\r\n        // controll.setDbEvents(dateBase,db.storeData);\r\n\r\n    }\r\n\r\n    return {init: main };\r\n})();\r\n\r\napp.init();\r\n"]}