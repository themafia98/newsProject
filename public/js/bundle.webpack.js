!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(7)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){e.exports=n.p+"img/javascript.png"},function(e,t,n){e.exports=n.p+"img/loading.gif"},function(e,t,n){e.exports=n.p+"img/technology.jpg"},function(e,t,n){"use strict";n.r(t);n(1),n(2),n(3),n(4),n(5),n(6);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var s=function(){function e(){o(this,e),this.state="index"}return i(e,[{key:"currentState",set:function(e){this.state=e},get:function(){return this.state}}]),e}(),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"top-headlines",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ru";o(this,e),this.KEY="92084bd2e2064d8d856eb2c499818785",this.URI="https://newsapi.org/v2/",this.CATEGORY="technology",this.type=t,this.country="country=".concat(n),this.buffer=!1,this.correctUTF=[],this.articlesNews=[],this.error=null}return i(e,[{key:"getCoords",value:function(){navigator.geolocation.getCurrentPosition(function(e){var t=e.coords,n={latitude:t.latitude,longitude:t.longitude,error:!1};localStorage.coords=JSON.stringify(n)},function(e){localStorage.coords=JSON.stringify({latitude:53.9130256,longitude:27.4998984,error:!0})})}},{key:"request",value:function(e,t,n){if(!window.fetch)return!1;window.fetch("".concat(this.URI+this.type,"?").concat(this.country,"&category=").concat(this.CATEGORY,"&apiKey=").concat(this.KEY)).then(function(e){return e.json()}).then(function(e){return sessionStorage.news=JSON.stringify(e.articles)}).then(function(o){return n.openDateBase(e,t,o)}).catch(function(n){sessionStorage.state=window.location.hash.slice(2),t.currentState=sessionStorage.state,e.showNews(),e.checkState(t),e.customElements(document.querySelector(".loader"),"delete")})}}],[{key:"mapInit",value:function(){if(!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.querySelector(".ol-viewport"))){var e=new ol.control.MousePosition({projection:"EPSG:4326",coordinateFormat:function(e){return ol.coordinate.format(e,"{y}, {x}",3)}});return new ol.Map({controls:ol.control.defaults().extend([new ol.control.ZoomSlider,e,new ol.control.OverviewMap,new ol.control.ScaleLine]),target:"map",layers:[new ol.layer.Tile({source:new ol.source.OSM})],view:new ol.View({center:ol.proj.fromLonLat([27.4998984,53.9130256]),zoom:7})})}}}]),e}(),c=function(){function e(){o(this,e),this.storeData=[],this.requestArticle=[],this.dbItems=null,this.itemCountDB=null}return i(e,[{key:"openDateBase",value:function(e,t,n){var o=this;if(this.requestArticle=JSON.parse(sessionStorage.news),window.indexedDB){var r=window.indexedDB.open("newsDB",1);r.onupgradeneeded=function(e){o.storeData=JSON.parse(sessionStorage.news);var t=event.target.result.createObjectStore("news",{autoIncrement:!0});t.createIndex("name","name",{unique:!1}),o.storeData.forEach(function(e){return t.add(e)})},r.onsuccess=function(n){var r=n.target.result;o.dbItems=r.transaction("news").objectStore("news").getAll(),o.dbItems.onsuccess=function(n){new Promise(function(e,t){var n=r.transaction("news","readwrite").objectStore("news");n.oncomplete(e(n))}).then(function(n){new Promise(function(e,t){n.openCursor().onsuccess=function(t){var n=t.target.result;if(!n)return e("done");n.key>54&&n.delete(),n.continue()}}).then(function(e){return r.transaction("news").objectStore("news").getAll()}).then(function(n){n.onsuccess=function(n){o.itemCountDB=o.dbItems.result.length-1;var i=n.target.result;o.correctUTF=[],o.buffer=i.length?i:o.requestArticle;var s=!0,a=!1,c=void 0;try{for(var l,u=o.buffer[Symbol.iterator]();!(s=(l=u.next()).done);s=!0){var d=l.value;d.source&&(d.name=d.source.name),d.source&&delete d.source,void 0!==d.author&&delete d.author,void 0!==d.content&&delete d.content}}catch(e){a=!0,c=e}finally{try{s||null==u.return||u.return()}finally{if(a)throw c}}var h=o.requestArticle.filter(function(e,t){return void 0===o.buffer.find(function(t){return t.description===e.description})});h.length&&h.forEach(function(e){return o.buffer.unshift(e)});var m=o.buffer||o.requestArticle;o.correctUTF=m.filter(function(e){return"Rg.ru"!=e.name});for(var p=r.transaction("news","readwrite"),f=0;f<o.correctUTF.length;f++)p.objectStore("news").put(o.correctUTF[f],f+1);sessionStorage.removeItem("news"),sessionStorage.itemCount=o.correctUTF.length-1,sessionStorage.state=window.location.hash.slice(2),t.currentState=sessionStorage.state,e.itemCountDB=o.itemCountDB,e.showNews(i),e.checkState(t),e.customElements(document.querySelector(".loader"),"delete")}}).catch(function(e){console.warn(e)})})}}}}}]),e}();function l(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("div");!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.content=null,this.menu=["main","about","contact"],this.news=localStorage.news?JSON.parse(localStorage.news):[],this.newsSection=[],this.count=6,this.countShow=18,this.lengthLoading=0,this.items=[],this.itemCountDB=null,this.components={header:null,footer:null,loadMoreBox:null,loadingNews:null,contentSection:null,nav:null,wrapperHeader:null,navigator:null,title:null,footerWrapper:null,footerPower:null}}var t,n,o;return t=e,(n=[{key:"updateBroswer",value:function(){var e=document.querySelector(".content"),t=document.createElement("h2");t.classList.add("updateIE"),t.innerHTML="Please update browser or if you use IE download a modern browser.",e.appendChild(t)}},{key:"showScrollUp",value:function(){var e=document.createElement("div");e.classList.add("scroll"),e.innerHTML='<i class="fa-2x fas fa-arrow-up positionIcon"></i>',this.ctx.appendChild(e)}},{key:"customElements",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Спрятать";e&&("disabled"===t&&e.setAttribute("disabled","true"),"delete"===t&&e.parentNode.removeChild(e),"rename"===t&&(e.value=n))}},{key:"loadingNews",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=l(document.getElementsByTagName("section")),o=document.querySelector(".content"),r=this.newsSection.length-1;if(this.items=[],n.forEach(function(t){var n;return(n=e.items).push.apply(n,l(t.children))}),this.newContent=this.news.filter(function(t,n){return n>e.items.length-1}),this.newContent.length){this.countShow=this.countShow>this.newContent.length?this.newContent.length:17;for(var i=Math.ceil(this.countShow/3),s=0;s<i;s++){var a=document.createElement("section");this.newsSection.push(a)}this.lengthLoading=this.newContent.length>this.countShow?this.countShow:this.newContent.length;for(var c=0;c<this.lengthLoading;c++){var u=document.createElement("a"),d=document.createElement("div"),h=document.createElement("img");h.src=this.newContent[c].urlToImage?this.newContent[c].urlToImage:"img/technology.jpg",h.classList.add("topic-image");var m=document.createElement("p");m.classList.add("article__content"),d.classList.add("article-col"),d.classList.add("rel-col"),u.href=this.newContent[c].url,u.setAttribute("target","_blank"),u.classList.add("article__content__read"),m.innerHTML=""!=this.newContent[c].description&&null!=this.newContent[c].description?this.newContent[c].description:this.newContent[c].title,d.appendChild(h),d.appendChild(m),d.appendChild(u),this.newsSection[r].appendChild(d),this.newsSection[r].children.length>=3&&r++}for(var p=7;p<this.newsSection.length;p++){var f=t.parentNode;o.insertBefore(this.newsSection[p],f)}this.items=[],this.items=document.querySelectorAll("div.article-col").length-1,this.items===this.itemCountDB&&this.customElements(document.querySelector(".loadingNewsBtn"),"delete")}else this.customElements(document.querySelector(".loadingNewsBtn"),"delete")}},{key:"showLoadingButton",value:function(){this.components.loadMoreBox=document.createElement("div"),this.components.loadMoreBox.classList.add("controllSection"),this.components.loadMoreBox=document.createElement("div"),this.components.loadMoreBox.classList.add("controllSection"),this.components.loadingNews=document.createElement("input"),this.components.loadingNews.setAttribute("type","button"),this.components.loadingNews.classList.add("loadingNewsBtn"),this.components.loadingNews.value="Загрузить",this.components.loadMoreBox.appendChild(this.components.loadingNews)}},{key:"showComponents",value:function(){this.ctx.innerHTML="",this.components.header=document.createElement("header"),this.components.footer=document.createElement("footer"),this.components.contentSection=document.createElement("div"),this.components.contentSection.classList.add("content"),this.components.nav=document.createElement("nav"),this.components.wrapperHeader=document.createElement("div"),this.components.navigator=document.createElement("ul"),this.components.navigator.classList.add("menu"),this.components.wrapperHeader.classList.add("row-center"),this.components.title=document.createElement("h1"),this.components.title.innerHTML="Technology news",this.components.title.classList.add("title"),this.components.footerWrapper=document.createElement("div"),this.components.footerWrapper.classList.add("footerWrapper"),this.components.footerPower=document.createElement("p"),this.components.footerPower.classList.add("footerWrapper__powerd"),this.components.footerPower.innerHTML="Create by themafia98 (Pavel P)";for(var e=0;e<3;e++){var t=document.createElement("li"),n=document.createElement("a");n.setAttribute("href","#!".concat(this.menu[e])),n.dataset.menu=this.menu[e],n.innerHTML=this.menu[e],t.appendChild(n),this.components.navigator.appendChild(t)}this.showLoadingButton(),this.components.nav.appendChild(this.components.navigator),this.components.footerWrapper.appendChild(this.components.footerPower),this.components.wrapperHeader.appendChild(this.components.title),this.components.wrapperHeader.appendChild(this.components.nav),this.components.footer.appendChild(this.components.footerWrapper),this.components.header.appendChild(this.components.wrapperHeader),this.ctx.appendChild(this.components.header),this.ctx.appendChild(this.components.contentSection),this.ctx.appendChild(this.components.footer),this.content=document.querySelector(".content")}},{key:"showNews",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.content.innerHTML="",this.items=document.querySelectorAll("div.article-col").length-1,this.newsSection=[],this.countShow=18,this.news=t,this.items===this.itemCountDB?this.customElements(document.querySelector(".loadingNewsBtn"),"delete"):this.showLoadingButton();for(var n=Math.ceil(this.countShow/3),o=0,r=0;r<n+1;r++){var i=document.createElement("section");this.newsSection.push(i)}for(var s=this.countShow+this.lengthLoading,a=0;a<s&&0!==this.news.length;a++){var c=document.createElement("a"),l=document.createElement("div"),u=document.createElement("img");u.src=this.news[a].urlToImage?this.news[a].urlToImage:"img/technology.jpg",u.classList.add("topic-image");var d=document.createElement("p");d.classList.add("article__content"),l.classList.add("article-col"),l.classList.add("rel-col"),0===a?(c.href=this.news[a].url,c.classList.add("hot-article__content__read"),c.setAttribute("target","_blank"),c.innerHTML="Читать",this.newsSection[a].classList.add("hot-topic"),d.classList.add("hot-topic_content"),u.classList.add("hot-image")):(c.href=this.news[a].url,c.setAttribute("target","_blank"),c.classList.add("article__content__read")),d.innerHTML=""!=this.news[a].description&&null!=this.news[a].description?this.news[a].description:this.news[a].title,l.appendChild(u),l.appendChild(d),l.appendChild(c),this.lengthLoading>0&&!this.newsSection[o]&&(this.newsSection[o]=document.createElement("section")),this.newsSection[o].appendChild(l),a%3==0&&o++}this.newsSection.forEach(function(t){return e.components.contentSection.appendChild(t)}),this.components.contentSection.appendChild(this.components.loadMoreBox),this.ctx.insertBefore(this.components.contentSection,this.components.header.nextSibling)}},{key:"checkState",value:function(e){"about"===e.currentState&&this.showAbout(),"contact"===e.currentState&&this.showContact(),"main"===e.currentState&&this.showNews(this.news)}},{key:"showAbout",value:function(){this.content.innerHTML="";var e=document.createElement("h2");e.classList.add("state-title"),e.innerHTML="About";var t=document.createElement("div");t.classList.add("aboutWrapper");var n=document.createElement("p");n.classList.add("aboutArticle"),n.innerHTML='This is a test project. Use a <a href = "https://newsapi.org/">News API</a>.';var o=document.createElement("p");o.classList.add("aboutMe"),o.innerHTML="My name is Pavel Petrovich and i like <strong>JavaScript</strong>.";var r=document.createElement("img");r.classList.add("imagesAbout"),r.src="img/javascript.png",t.appendChild(n),t.appendChild(o),r.onload=function(){return t.appendChild(r)},this.content.appendChild(e),this.content.appendChild(t)}},{key:"showContact",value:function(){this.content.innerHTML="";var e=document.createElement("h2");e.classList.add("state-title"),e.innerHTML="Contact";var t=document.createElement("div");t.classList.add("aboutWrapper");var n=document.createElement("p");n.classList.add("contact-links"),n.innerHTML='<a href = "https://github.com/themafia98"><i class="fab fa-github-square"></i></a> <a href = "https://www.linkedin.com/in/pavel-p-80887b151/"><i class="fab fa-linkedin"></i></a>';var o=document.createElement("div");o.setAttribute("id","map"),t.appendChild(n),this.content.appendChild(e),this.content.appendChild(t),this.content.appendChild(o);var r=a.mapInit(),i=JSON.parse(localStorage.coords),s=document.querySelector(".ol-viewport"),c=document.createElement("div");c.classList.add("markerCurrent");var l=document.createElement("div");if(l.classList.add("marker"),s.appendChild(c),s.appendChild(l),i.error)document.querySelector(".marker").style.display="none";else{var u=new ol.Overlay({position:ol.proj.fromLonLat([i.longitude,i.latitude]),element:document.querySelector(".marker"),positioning:"bottom-center"});r.addOverlay(u)}var d=new ol.Overlay({position:ol.proj.fromLonLat([27.4998984,53.9130256]),element:document.querySelector(".markerCurrent"),positioning:"bottom-center"});r.addOverlay(d)}},{key:"showLoader",value:function(){document.getElementById("newsApp");var e=document.createElement("div");e.classList.add("loadingWrapper");var t=document.createElement("img");t.classList.add("loader"),t.src="img/loading.gif",e.appendChild(t),this.ctx.insertBefore(e,this.components.header.nextSibling)}}])&&u(t.prototype,n),o&&u(t,o),e}();function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.menu=null,this.menuTitle=null,this.timer=null,this.scrolled=null,this.clickScrollCount=0}var t,n,o;return t=e,(n=[{key:"setDbEvents",value:function(e,t){e.onupgradeneeded=function(e){var n=e.target.result.createObjectStore("news",{autoIncrement:!0});n.createIndex("name","name",{unique:!1});for(var o=0;o<t.length;o++)n.add(t[o])},e.onsuccess=function(e){e.target.result.transaction(["news"],"readwrite").objectStore("news").openCursor().onsuccess=function(e){var t=e.target.result;t&&t.continue()}}}},{key:"setEvents",value:function(e,t,n){var o=this;function r(t){var n=t.target;"loadingNewsBtn"!==n.classList[0]?"scroll"!==n.parentNode.classList[0]&&"scroll"!==n.classList[0]||0!==o.clickScrollCount||(o.clickScrollCount++,o.timer=setInterval(function(){document.documentElement.scrollTop=document.documentElement.scrollTop-20},0)):e.loadingNews(n)}console.log("touchevents detected:"+Modernizr.touchevents),Modernizr.touchevents&&document.addEventListener("touchend",r,!1),!Modernizr.touchevents&&document.addEventListener("click",r,!1),window.addEventListener("storage",function(t){e.showNews()},!1),document.addEventListener("scroll",function(t){if(o.menu=document.getElementsByTagName("nav")[0],o.scrolled=window.pageYOffset||document.documentElement.scrollTop,null!=o.timer&&0===o.scrolled&&(clearInterval(o.timer),o.clickScrollCount=0),o.scrolled>100)o.menu.classList.add("fixed-menu"),!document.querySelector(".scroll")&&!Modernizr.touchevents&&e.showScrollUp();else if("fixed-menu"==o.menu.classList[0]&&o.scrolled<100){var n=document.querySelector(".scroll");o.menu.classList.toggle("fixed-menu"),n&&n.parentNode.removeChild(n)}},!1),document.addEventListener("DOMContentLoaded",function(){"main"===window.location.hash.slice(2)&&(window.location.hash="")},!1),window.addEventListener("hashchange",function(t){sessionStorage.state=window.location.hash.slice(2),n.currentState=sessionStorage.state,e.checkState(n)})}}])&&h(t.prototype,n),o&&h(t,o),e}();!function(){var e=new s,t=new a,n=new c;t.getCoords();var o=new d(document.getElementById("newsApp"));(new m).setEvents(o,t,e),o.showComponents(),o.showLoader(),!1===t.request(o,e,n)&&(o.customElements(document.querySelector(".loader"),"delete"),o.updateBroswer())}()}]);
//# sourceMappingURL=http://localhost:5500/bundle.webpack.js.map